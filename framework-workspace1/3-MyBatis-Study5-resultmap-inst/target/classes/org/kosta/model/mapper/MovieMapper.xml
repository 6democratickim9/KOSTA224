<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.kosta.model.mapper.MovieMapper">
	<insert id="registerDirector" parameterType="DirectorVO">
		insert into
		director(director_id,director_name,intro)values(director_seq.nextval,#{directorName},#{intro})
	</insert>
	<select id="getAllDirectorList" resultType="DirectorVO">
	select director_id,director_name,intro from director order by director_id desc
	</select>
	<!-- MovieVo has a DirectorVO:#{directorVO.directorId} -->
	<insert id="registerMovie" parameterType="MovieVO">
	insert into movie(movie_id,title,genre,attendance,director_id)
	values(movie_seq.nextval,#{title},#{genre},#{attendance},#{directorVO.directorId})
	</insert>
	<!-- 영화 리스트를 조회하기 위한 resultmap
	MovieVO has a DirectorVO 형식으로 결과값을 반환받기 위한 resultmap
	MovieVO의 인스턴스 변수인 directorVo에 감독객체를 할당하고 directorVO의
	directorName에 감독이름을 할당하기 위해서는 resultmap을 이용해야 함 -->
	<resultMap type="MovieVO" id="movieListRM">
	<result column="director_name" property="directorVO.directorName"/>
	<!-- resultType이 아니라 위에서 정의한 reusltMap으로 반환속성 지정 -->
	<select id="getAllMovieList" resultMap="movieListRM">
	select m.title,d.director_name
	from movie m, director d
	where m.director_id=d.director_id
	</select>	
	
	</resultMap>
</mapper>